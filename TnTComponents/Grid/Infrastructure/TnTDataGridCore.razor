@using Microsoft.AspNetCore.Components.Rendering
@typeparam TGridItem
@inherits TnTComponentBase
@implements IDisposable

<div class="@_gridSettings.ContainerClass" style="@GetContainerStyle()">
    <table @attributes=@AdditionalAttributes class="@GetClass()" style="@Style" theme="@Theme" @ref="@Element">
        <thead>
            <tr>
                @if (_gridSettings.ShowRowIndex) {
                    <th></th>
                }

                @foreach (var item in _context.Columns.Select((Column, Index) => new { Column, Index })) {
                    var column = item.Column;
                    var index = item.Index;
                    if (_sortedOn == null && column.DefaultSort) {
                        DefaultSort(column);
                    }
                    <th @key="@column"
                        class="@(column.Sortable ? "tnt-sortable" : string.Empty)"
                        scope="col"
                        nowrap="nowrap">

                        <a href="@BuildHref(column.Sortable, index)" class="@GetAnchorClass(index) @(_sortedOn == column ? "active" : string.Empty)">
                            @column.RenderHeaderContent()

                            @if (_sortedOn == column) {
                                @TnTIconComponent.RenderIcon(_gridSettings.IconType, "keyboard_arrow_down")
                            }
                        </a>
                    </th>
                }
            </tr>
        </thead>
        <tbody>
            @if (_gridSettings.Items is not null) {
                foreach (var item in _gridSettings.Items.Select((Item, Index) => new { Item, Index = Index + 1 })) {
                    var index = item.Index;
                    var rowItem = item.Item;

                    <TnTDataGridRow Item="rowItem" ShowRowIndex="@_gridSettings.ShowRowIndex" />
                }
            }
        </tbody>
    </table>
</div>

@if (!_gridSettings.Appearance.HasFlag(DataGridAppearance.Compat)) {
    <TnTPageScript Src="@($"./_content/TnTComponents/Grid/Infrastructure/TnTDataGridCore.razor.js?tntdatagrididentifier={ComponentIdentifier}")" />
}
<TnTPageScript Src="./_content/TnTComponents/TnTButton.razor.js?class=tnt-sortable" />

@code {

    private void RenderHeaderContent(RenderTreeBuilder __builder) {

    }

    private void RenderRowContent(RenderTreeBuilder __builder) {

    }
}